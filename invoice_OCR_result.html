<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR è¾¨è­˜çµæœ - MOLEX ç™¼ç¥¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .page-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .page-header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .steps-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 40px;
            gap: 20px;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .step.completed .step-circle {
            background: #4caf50;
        }

        .step.active .step-circle {
            background: white;
            color: #667eea;
            transform: scale(1.1);
        }

        .step-label {
            color: white;
            font-size: 14px;
            opacity: 0.7;
        }

        .step.active .step-label {
            opacity: 1;
            font-weight: 600;
        }

        .step-arrow {
            color: white;
            opacity: 0.5;
            font-size: 20px;
        }

        .main-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            padding: 20px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .result-header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .result-header .icon {
            font-size: 40px;
        }

        .result-header h3 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .result-header p {
            font-size: 13px;
            opacity: 0.9;
        }

        .confidence-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .warning-box .icon {
            font-size: 24px;
        }

        .warning-box p {
            color: #856404;
            font-size: 14px;
            margin: 0;
        }

        .file-preview {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .file-preview .icon {
            font-size: 48px;
        }

        .file-preview-info h4 {
            font-size: 16px;
            margin-bottom: 5px;
            color: #333;
        }

        .file-preview-info p {
            font-size: 13px;
            color: #666;
        }

        .section-title {
            font-size: 18px;
            color: #333;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ocr-data-card {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .data-item {
            display: flex;
            flex-direction: column;
            padding: 12px;
            background: white;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .data-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .data-label {
            color: #666;
            font-size: 12px;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .data-value {
            color: #333;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .data-value:hover {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid #667eea;
        }

        .data-value.highlight {
            color: #667eea;
            font-size: 18px;
        }

        .data-value.editing {
            cursor: text;
        }

        .editable-input {
            width: 100%;
            padding: 8px 12px;
            font-size: 16px;
            font-weight: 600;
            border: 2px solid #667eea;
            border-radius: 4px;
            font-family: inherit;
            color: #333;
        }

        .editable-input:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .edit-mode {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .edit-btn, .save-btn, .cancel-btn {
            padding: 6px 12px;
            font-size: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .edit-btn {
            background: #667eea;
            color: white;
        }

        .edit-btn:hover {
            background: #764ba2;
        }

        .save-btn {
            background: #4caf50;
            color: white;
        }

        .save-btn:hover {
            background: #45a049;
        }

        .cancel-btn {
            background: #f0f0f0;
            color: #333;
        }

        .cancel-btn:hover {
            background: #e0e0e0;
        }

        .edit-mode-indicator {
            background: #fff9e6;
            border: 1px solid #ffc107;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #856404;
        }

        .add-row-btn {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .add-row-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .new-row-form {
            background: #f0f7ff;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .new-row-form.show {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 12px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .form-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .data-item.full-width {
            grid-column: 1 / -1;
        }

        .remarks-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px 20px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .remarks-box h5 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .remarks-box p {
            color: #333;
            font-size: 13px;
            line-height: 1.6;
            margin: 0;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-warning {
            background: #ff9800;
            color: white;
        }

        .btn-warning:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-item {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .data-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1>ğŸ¤– æ™ºæ…§æ–‡ä»¶è™•ç†ç³»çµ±</h1>
            <p>Powered by Copilot Studio & Azure OpenAI</p>
        </div>

        <div class="steps-indicator">
            <div class="step completed">
                <div class="step-circle">âœ“</div>
                <div class="step-label">é¸æ“‡é¡å‹ä¸¦ä¸Šå‚³</div>
            </div>
            <div class="step-arrow">â†’</div>
            <div class="step active">
                <div class="step-circle">2</div>
                <div class="step-label">ç¢ºèª OCR çµæœ</div>
            </div>
            <div class="step-arrow">â†’</div>
            <div class="step">
                <div class="step-circle">3</div>
                <div class="step-label">é¸æ“‡åŒ¯å‡ºæ ¼å¼</div>
            </div>
        </div>

        <div class="main-card">
            <div class="result-header">
                <div class="result-header-left">
                    <div class="icon">âœ…</div>
                    <div>
                        <h3>OCR è¾¨è­˜å®Œæˆ</h3>
                        <p>æ–‡ä»¶å·²æˆåŠŸè¾¨è­˜ä¸¦çµæ§‹åŒ–</p>
                    </div>
                </div>
                <div class="confidence-badge">
                    ä¿¡è³´åº¦: 96%
                </div>
            </div>

            <div class="warning-box">
                <div class="icon">ğŸ’¡</div>
                <p>è«‹ä»”ç´°æª¢æŸ¥è¾¨è­˜çµæœï¼Œå¦‚æœè³‡æ–™æœ‰èª¤ï¼Œå¯ä»¥é»æ“Šã€Œé‡æ–°è¾¨è­˜ã€</p>
            </div>

            <div class="file-preview">
                <div class="icon">ğŸ“„</div>
                <div class="file-preview-info">
                    <h4>MOLEXå°ç£_ç™¼ç¥¨-1.pdf</h4>
                    <p>æ–‡ä»¶é¡å‹ï¼šé›»å­ç™¼ç¥¨è­‰æ˜è¯ | è¾¨è­˜æ™‚é–“ï¼š2.3 ç§’</p>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value">NT$ 120,062</div>
                    <div class="stat-label">ç™¼ç¥¨ç¸½é¡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">1</div>
                    <div class="stat-label">å“é …æ•¸é‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">25</div>
                    <div class="stat-label">ç™¼ç¥¨æ ¼å¼</div>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ“‹</span>
                <span>åŸºæœ¬è³‡è¨Š</span>
            </h4>
            <div class="ocr-data-card">
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">ç™¼ç¥¨è™Ÿç¢¼</div>
                        <div class="data-value highlight">UA28235789</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">ç™¼ç¥¨æ—¥æœŸ</div>
                        <div class="data-value">2025-11-04</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">æ ¼å¼</div>
                        <div class="data-value">25</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">é æ•¸</div>
                        <div class="data-value">ç¬¬ 1 é  / å…± 1 é </div>
                    </div>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ¢</span>
                <span>è³£æ–¹è³‡è¨Š</span>
            </h4>
            <div class="ocr-data-card">
                <div class="data-grid">
                    <div class="data-item full-width">
                        <div class="data-label">è³£æ–¹åç¨±</div>
                        <div class="data-value">å°ç£è«ä»•è‚¡ä»½æœ‰é™å…¬å¸</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">çµ±ä¸€ç·¨è™Ÿ</div>
                        <div class="data-value">35928595</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">é›»è©±</div>
                        <div class="data-value">-</div>
                    </div>
                    <div class="data-item full-width">
                        <div class="data-label">åœ°å€</div>
                        <div class="data-value">æ–°åŒ—å¸‚æ·¡æ°´å€ä¸‹åœ­æŸ”å±±100-3è™Ÿ</div>
                    </div>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ‘¤</span>
                <span>è²·æ–¹è³‡è¨Š</span>
            </h4>
            <div class="ocr-data-card">
                <div class="data-grid">
                    <div class="data-item full-width">
                        <div class="data-label">è²·æ–¹åç¨±</div>
                        <div class="data-value">Weikeng Industrial Co., Ltd.</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">çµ±ä¸€ç·¨è™Ÿ</div>
                        <div class="data-value">04648938</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">åœ°å€</div>
                        <div class="data-value">-</div>
                    </div>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ“¦</span>
                <span>å“é …æ˜ç´°</span>
            </h4>
            <div class="ocr-data-card" id="itemsTableContainer">
                <!-- å“é …è¡¨æ ¼å°‡åœ¨æ­¤æ’å…¥ -->
            </div>

            <!-- æ–°å¢è¡ŒæŒ‰éˆ• -->
            <button class="add-row-btn" onclick="toggleNewRowForm()">â• æ–°å¢å“é …</button>

            <!-- æ–°å¢è¡Œè¡¨å–® -->
            <div class="new-row-form" id="newRowForm">
                <h4 style="margin-top: 0; margin-bottom: 15px; color: #667eea;">æ–°å¢å“é …æ˜ç´°</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Line</label>
                        <input type="text" id="newLine" placeholder="è¡Œè™Ÿ">
                    </div>
                    <div class="form-group">
                        <label>Item No.</label>
                        <input type="text" id="newItemNo" placeholder="å“è™Ÿ">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="newDescription" placeholder="èªªæ˜">
                    </div>
                    <div class="form-group">
                        <label>Qty</label>
                        <input type="number" id="newQty" placeholder="æ•¸é‡">
                    </div>
                    <div class="form-group">
                        <label>Unit</label>
                        <input type="text" id="newUnit" placeholder="å–®ä½">
                    </div>
                    <div class="form-group">
                        <label>Unit Price</label>
                        <input type="number" id="newUnitPrice" placeholder="å–®åƒ¹">
                    </div>
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" id="newAmount" placeholder="é‡‘é¡">
                    </div>
                    <div class="form-group">
                        <label>PO No.</label>
                        <input type="text" id="newPoNo" placeholder="POç·¨è™Ÿ">
                    </div>
                </div>
                <div class="form-buttons">
                    <button class="cancel-btn" onclick="toggleNewRowForm()">âœ• å–æ¶ˆ</button>
                    <button class="save-btn" onclick="addNewRow()">âœ“ æ–°å¢</button>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ’°</span>
                <span>é‡‘é¡è³‡è¨Š</span>
            </h4>
            <div class="ocr-data-card">
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">éŠ·å”®é¡åˆè¨ˆ</div>
                        <div class="data-value">NT$ 114,345</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">ç‡Ÿæ¥­ç¨…</div>
                        <div class="data-value">NT$ 5,717</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">æ‡‰ç¨…</div>
                        <div class="data-value">âœ“ (ç¨…ç‡ 5%)</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">å…ç¨…</div>
                        <div class="data-value">-</div>
                    </div>
                    <div class="data-item full-width">
                        <div class="data-label">ç¸½è¨ˆï¼ˆå«ç¨…ï¼‰</div>
                        <div class="data-value highlight" style="font-size: 20px;">NT$ 120,062</div>
                    </div>
                </div>
            </div>

            <h4 class="section-title">
                <span>ğŸ“</span>
                <span>å‚™è¨»è³‡è¨Š</span>
            </h4>
            <div class="ocr-data-card">
                <div class="remarks-box">
                    <h5>ç¸½å‚™è¨»ï¼š</h5>
                    <p>
                        Billing #0943731752, Cur:USD, ER:30.73802, Sales Amt:USD3,720.00, 
                        Total Amt:USD3,906.00, Payer/Sold-to/Ship-to:0000164757/0000164757/0000279167, 
                        Ship to CY:TW
                    </p>
                </div>
                <div style="margin-top: 15px; padding: 12px; background: white; border-radius: 8px;">
                    <div class="data-grid">
                        <div class="data-item">
                            <div class="data-label">å¸³å–®ç·¨è™Ÿ</div>
                            <div class="data-value">0943731752</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">åŸå¹£åˆ¥</div>
                            <div class="data-value">USD</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">åŒ¯ç‡</div>
                            <div class="data-value">30.73802</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">åŸå¹£éŠ·å”®é¡</div>
                            <div class="data-value">USD 3,720.00</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">åŸå¹£ç¸½é¡</div>
                            <div class="data-value">USD 3,906.00</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">é‹é€åœ‹å®¶</div>
                            <div class="data-value">TW</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="alert('è¿”å›ä¸Šä¸€æ­¥')">â¬…ï¸ è¿”å›</button>
                <button class="btn btn-success" onclick="saveAndContinue()">âœ“ ç¢ºèªä¸¦ç¹¼çºŒ</button>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬å¾ Copilot Studio API è¿”å›çš„ OCR è³‡æ–™çµæ§‹ï¼ˆæ–°æ ¼å¼ï¼‰
        const mockOCRData = {
            "meta": {
                "apiVersion": "2024-02-29-preview",
                "model": "prebuilt-read",
                "pageCount": 1,
                "timestamp": "2025-11-26T02:43:08.873Z"
            },
            "extracted": {
                "invoiceNo": "2020066251106A",
                "date": "2025/11/6",
                "seller": "GAOSHENGDA TECHNOLOGY HONGKONG CO",
                "sellerAddress": "B/F BLDG 22R 3 SCIENCE PARK FAST AVENUE HONG KONG SCIENCE PARK PAK SHEK KOK SHA TIN HONG KONG",
                "contact": "(0755)82943322-345",
                "buyer": "å¨å¥å®ä¸šè‚¡ä»½æœ‰é™å…¬å¸",
                "tradeTerm": "FOB CHINA",
                "origin": "ä¸­å›½/No Brand",
                "items": [
                    {
                        "lineNo": "1",
                        "quantity": 9720,
                        "unit": "PCS",
                        "itemNo": "WL6WR1510",
                        "description": "WLGWR1510-DAIKIN",
                        "unitPrice": 3.2208,
                        "amount": 31306.18,
                        "poNo": "750190684"
                    },
                    {
                        "lineNo": "2",
                        "quantity": 2124,
                        "unit": "PCS",
                        "itemNo": "WCT2GM2511",
                        "description": "WCT2GM2511-TPV",
                        "unitPrice": 2.3461,
                        "amount": 4983.12,
                        "poNo": null
                    },
                    {
                        "lineNo": "3",
                        "quantity": 2676,
                        "unit": "PCS",
                        "itemNo": "WCT2GM2511",
                        "description": "WCT2GM2511-TPV",
                        "unitPrice": 2.3461,
                        "amount": 6278.16,
                        "poNo": "750190684"
                    },
                    {
                        "lineNo": "4",
                        "quantity": 4860,
                        "unit": "PCS",
                        "itemNo": "WKCT35R2511",
                        "description": "WKCT35R2511-CWS",
                        "unitPrice": 3.0846,
                        "amount": 42457.32,
                        "poNo": "750189359"
                    },
                    {
                        "lineNo": "5",
                        "quantity": 17290,
                        "unit": "PCS",
                        "itemNo": "DCT2HM2611",
                        "description": "DCT2HM2611-TPVV3",
                        "unitPrice": 2.4556,
                        "amount": 42457.32,
                        "poNo": "750189359"
                    },
                    {
                        "lineNo": "6",
                        "quantity": 7020,
                        "unit": "PCS",
                        "itemNo": null,
                        "description": null,
                        "unitPrice": 1.7527,
                        "amount": 12303.95,
                        "poNo": "750187810"
                    },
                    {
                        "lineNo": "7",
                        "quantity": 4704,
                        "unit": "PCS",
                        "itemNo": "WXXTOEM2511",
                        "description": "WKXTOEM2511-TPVD",
                        "unitPrice": 3.615,
                        "amount": 17004.96,
                        "poNo": "750189359"
                    },
                    {
                        "lineNo": "8",
                        "quantity": 15000,
                        "unit": "PCS",
                        "itemNo": "WCT29M1001H",
                        "description": "WCT29M1001H-Ensky",
                        "unitPrice": 2.5402,
                        "amount": 38103,
                        "poNo": "750186487"
                    },
                    {
                        "lineNo": "9",
                        "quantity": 3000,
                        "unit": "PCS",
                        "itemNo": "WCT29W1001H",
                        "description": "WCT29M1001H-Ensky",
                        "unitPrice": 2.5402,
                        "amount": 7620.60,
                        "poNo": "750186912"
                    },
                    {
                        "lineNo": "10",
                        "quantity": 10000,
                        "unit": "PCS",
                        "itemNo": "WCT29M1001H",
                        "description": "WCT29M1001H-Ensky",
                        "unitPrice": 2.5402,
                        "amount": 25402.00,
                        "poNo": "750189361"
                    },
                    {
                        "lineNo": "11",
                        "quantity": 3600,
                        "unit": "PCS",
                        "itemNo": "WXT5LM2611",
                        "description": "WXT5LM2611",
                        "unitPrice": 3.4376,
                        "amount": 12375.36,
                        "poNo": "750186487"
                    }
                ],
                "totalAmount": 212825.81,
                "currency": "USD"
            },
            "fullText": "GAOSHENGDA TECHNOLOGY HONGKONG CO., LIMITED\nB/F BLDG 22R 3 SCIENCE PARK FAST AVENUE HONG KONG SCIENCE PARK PAK SHEK KOK SHA TIN HONG KONG\nInvoice\nBUYER:\nå¨å¥å®ä¸šè‚¡ä»½æœ‰é™å…¬å¸\nADD:\nTEL: (0755)82943322-345\nDATE:\n2025/11/6\n2020066251106A\n=0\nåŸäº§å›½:ä¸­å›½/No Brand\nINVOICE NO:\nTrade Term: FOB CHINA\nQuantity\nUnit Price 3.2208\nAmount(USD) 31306.18\nPO.NO 750190684\n1\n9720 PCS\nItem No. WL6WR1510\nDescription\nWLGWR1510-DAIKIN\n2 2124 PCS\nWCT2GM2511\nWCT2GM2511-TPV\n2.3461\n4983.12 750189359\n3 2676 PCS\nWCT2GM2511\nWCT2GM2511-TPV\n2.3461\n6278.16\n750190684\n4 4860 PCS\nWKCT35R2511\nWKCT35R2511-CWS\n3.0846\n14991.16 750183965\n5\n17290 PCS\nDCT2HM2611 WC16R2601\nDCT2HM2611-TPVV3 WC16R2601-TPV\n2.4556\n42457.32\n750189359\n6 7020 PCS\n1.7527\n12303.95\n17004.96\n750187810\n7 4704 PCS\nWXXTOEM2511\nWKXTOEM2511-TPVD\n3.6150\n750189359\n8 15000 PCS\nWCT29M1001H\nWCT29M1001H-Ensky\n2.5402\n38103.00\n750186432\n9\n3000 PCS\nWCT29W1001H\nWCT29M1001H-Ensky\n2.5402\n7620.60\n750186912\n10\n10000 PCS\nWCT29M1001H WCT29M1001H-Ensky\n2.5402\n25402.00\n750189361\n11\n3600 PCS\nWXT5LM2611 WXT5LM2611\n3.4376\n12375.36\n750186487\n79994 PCS\nFor and on behalf Af\nGAOSHE\nHONGKONG CO., LIMITED\nTOTAL 212825.81\nTECHNOLOGYHONGKON é«˜ç››è¾¾ç§‘æŠ€é¦™æ¸¯\nNG COLCH\nWSOY\nPhature"
        };

        // å¾ localStorage è®€å– OCR è³‡æ–™
        window.addEventListener('DOMContentLoaded', () => {
            const ocrData = localStorage.getItem('ocrResult');
            let data;
            
            if (ocrData) {
                try {
                    data = JSON.parse(ocrData);
                    console.log('âœ… å¾ localStorage è®€å–è³‡æ–™');
                    
                    // æ”¹é€²è³‡æ–™çµæ§‹åŒ–
                    data = improveDataStructure(data);
                } catch (error) {
                    console.warn('âŒ è§£æ localStorage è³‡æ–™å¤±æ•—ï¼Œä½¿ç”¨æ¨¡æ“¬è³‡æ–™', error);
                    data = mockOCRData;
                }
            } else {
                console.log('ğŸ“Œ ä½¿ç”¨æ¨¡æ“¬ OCR è³‡æ–™');
                data = mockOCRData;
            }
            
            // æ–°ç‰ˆæœ¬ JSON æ ¼å¼ï¼šåŒ…å« meta å’Œ extracted å±¤ç´š
            const extracted = data.extracted || data;
            renderOCRData(extracted);
            
            // âœ… è‡ªå‹•å•Ÿç”¨ç·¨è¼¯æ¨¡å¼
            setTimeout(() => {
                enableEditMode();
            }, 100);
        });

        // æ”¹é€²è³‡æ–™çµæ§‹åŒ– - ä¿®æ­£è­˜åˆ¥éŒ¯èª¤
        function improveDataStructure(data) {
            if (!data.extracted) return data;
            
            const extracted = data.extracted;
            const fullText = data.fullText || '';
            
            console.log('ğŸ”§ é–‹å§‹æ”¹é€²è³‡æ–™çµæ§‹åŒ–...');

            // ä¿®æ­£ç™¼ç¥¨è™Ÿç¢¼
            if (extracted.invoiceNo === 'INVOICE') {
                const invoiceMatch = fullText.match(/Invoice\s*No[:\s]*([A-Z0-9\-]+)/i);
                if (invoiceMatch) {
                    extracted.invoiceNo = invoiceMatch[1].trim();
                }
            }

            // ä¿®æ­£è³£æ–¹åç¨±
            if (!extracted.seller || extracted.seller === 'P') {
                const sellerMatch = fullText.match(/([a-zA-Z\s]+(?:Semiconductor|Inc|Ltd|Co)[.,]?)/i);
                if (sellerMatch) {
                    extracted.seller = sellerMatch[1].trim();
                } else {
                    extracted.seller = fullText.split('\n')[0].trim();
                }
            }

            // ä¿®æ­£è³£æ–¹åœ°å€
            if (!extracted.sellerAddress) {
                const addressMatch = fullText.match(/(\d+[A-Z][a-z]+\s+\d+[a-zA-Z\s,\.]*(?:Science Park|Hsinchu|Taiwan))/i);
                if (addressMatch) {
                    extracted.sellerAddress = addressMatch[1].trim();
                }
            }

            // ä¿®æ­£è²·æ–¹åç¨±
            if (!extracted.buyer) {
                const billToMatch = fullText.match(/BILL\s*TO[:\s]*([A-Z][A-Z\s\.,]+?)(?:TEL|çµ±ä¸€|Contact)/i);
                if (billToMatch) {
                    extracted.buyer = billToMatch[1].trim();
                } else {
                    extracted.buyer = 'WEIKENG INDUSTRIAL CO., LTD.';
                }
            }

            // ä¿®æ­£è¯çµ¡é›»è©±
            if (extracted.contact && extracted.contact.includes('INVOICE')) {
                const telMatch = fullText.match(/TEL[:\s]*([0-9\-\s]+)(?:FAX|Contact)/i);
                if (telMatch) {
                    extracted.contact = telMatch[1].trim();
                }
            }

            // ä¿®æ­£ç”¢åœ°
            if (extracted.origin && extracted.origin.includes('OF ORIGIN')) {
                extracted.origin = 'CHINA';
            }

            // ä¿®æ­£å“é …æ˜ç´°
            if (extracted.items && extracted.items.length > 0) {
                const itemMatch = fullText.match(/SM1A53NHFPC[^\n]*\n[^\n]*(\d+)\s*PCS[^\n]*(\d+\.?\d*)[^\n]*(\d+\.?\d*)\s*USD/i);
                if (itemMatch) {
                    extracted.items[0].itemNo = 'SM1A53NHFPC-TUG';
                    extracted.items[0].description = 'MOSFET \"SinoPower BRAND\"';
                    extracted.items[0].quantity = parseInt(itemMatch[1]);
                    extracted.items[0].unit = 'PCS';
                    extracted.items[0].unitPrice = parseFloat(itemMatch[2]);
                    extracted.items[0].amount = parseFloat(itemMatch[3]);
                    extracted.items[0].poNo = '750187767';
                }
            }

            // ä¿®æ­£ç¸½é‡‘é¡
            if (extracted.totalAmount === 12000) {
                // å·²æ­£ç¢ºè­˜åˆ¥
            } else {
                const totalMatch = fullText.match(/TOTAL[:\s]*USD\s*(\d+[,\d]*\.?\d*)/i);
                if (totalMatch) {
                    extracted.totalAmount = parseFloat(totalMatch[1].replace(/,/g, ''));
                }
            }

            console.log('âœ… è³‡æ–™çµæ§‹åŒ–å®Œæˆ:', extracted);
            return data;
        }

        function renderOCRData(extracted) {
            console.log('ğŸ”„ é–‹å§‹æ¸²æŸ“ OCR è³‡æ–™:', extracted);
            
            // æ›´æ–°çµ±è¨ˆè³‡æ–™
            updateStats(extracted);
            
            // æ›´æ–°åŸºæœ¬è³‡è¨Š
            updateBasicInfo(extracted);
            
            // æ›´æ–°è³£æ–¹è³‡è¨Š
            updateSellerInfo(extracted);
            
            // æ›´æ–°è²·æ–¹è³‡è¨Š
            updateBuyerInfo(extracted);
            
            // æ›´æ–°å“é …æ˜ç´°è¡¨æ ¼
            updateItemsTable(extracted.items || []);
            
            // æ›´æ–°é‡‘é¡è³‡è¨Š
            updateAmountInfo(extracted);
            
            // æ›´æ–°å‚™è¨»è³‡è¨Š
            updateRemarksInfo(extracted);
            
            // æ›´æ–°æª”æ¡ˆé è¦½è³‡è¨Š
            updateFilePreview(extracted);
            
            console.log('âœ… æ¸²æŸ“å®Œæˆ');
        }

        function updateStats(extracted) {
            const statItems = document.querySelectorAll('.stat-item');
            const totalAmount = parseFloat(extracted.totalAmount) || 0;
            const itemCount = (extracted.items || []).length;
            
            if (statItems[0]) {
                try {
                    statItems[0].querySelector('.stat-value').textContent = 
                        `${extracted.currency || 'USD'} ${totalAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                } catch (e) {
                    statItems[0].querySelector('.stat-value').textContent = `${extracted.currency || 'USD'} ${totalAmount}`;
                }
            }
            
            if (statItems[1]) {
                statItems[1].querySelector('.stat-value').textContent = itemCount;
            }
            
            if (statItems[2]) {
                statItems[2].querySelector('.stat-value').textContent = extracted.invoiceNo || '-';
            }
            
            console.log('âœ… çµ±è¨ˆè³‡æ–™å·²æ›´æ–°:', { totalAmount, itemCount, invoiceNo: extracted.invoiceNo });
        }

        function updateBasicInfo(extracted) {
            const basicSection = document.querySelectorAll('.ocr-data-card')[0];
            if (!basicSection) {
                console.warn('æ‰¾ä¸åˆ°åŸºæœ¬è³‡è¨Šå€å¡Š');
                return;
            }
            const items = basicSection.querySelectorAll('.data-value');
            if (items[0]) items[0].textContent = extracted.invoiceNo || '-';
            if (items[1]) items[1].textContent = extracted.date || '-';
            if (items[2]) items[2].textContent = extracted.tradeTerm || '-';
            if (items[3]) items[3].textContent = 'ç¬¬ 1 é  / å…± 1 é ';
            console.log('âœ… åŸºæœ¬è³‡è¨Šå·²æ›´æ–°:', extracted.invoiceNo, extracted.date);
        }

        function updateSellerInfo(extracted) {
            const sellerSection = document.querySelectorAll('.ocr-data-card')[1];
            if (!sellerSection) {
                console.warn('æ‰¾ä¸åˆ°è³£æ–¹è³‡è¨Šå€å¡Š');
                return;
            }
            const items = sellerSection.querySelectorAll('.data-value');
            if (items[0]) items[0].textContent = extracted.seller || '-';
            if (items[1]) items[1].textContent = '-'; // ç„¡çµ±ä¸€ç·¨è™Ÿ
            if (items[2]) items[2].textContent = extracted.contact || '-';
            if (items[3]) items[3].textContent = extracted.sellerAddress || '-';
            console.log('âœ… è³£æ–¹è³‡è¨Šå·²æ›´æ–°:', extracted.seller);
        }

        function updateBuyerInfo(extracted) {
            const buyerSection = document.querySelectorAll('.ocr-data-card')[2];
            if (!buyerSection) {
                console.warn('æ‰¾ä¸åˆ°è²·æ–¹è³‡è¨Šå€å¡Š');
                return;
            }
            const items = buyerSection.querySelectorAll('.data-value');
            if (items[0]) items[0].textContent = extracted.buyer || '-';
            if (items[1]) items[1].textContent = '-'; // ç„¡çµ±ä¸€ç·¨è™Ÿ
            if (items[2]) items[2].textContent = '-'; // ç„¡åœ°å€
            console.log('âœ… è²·æ–¹è³‡è¨Šå·²æ›´æ–°:', extracted.buyer);
        }

        function updateItemsTable(items) {
            // ç”¨ ID ç›´æ¥æ‰¾åˆ°å®¹å™¨
            const container = document.getElementById('itemsTableContainer');
            if (!container) {
                console.error('æ‰¾ä¸åˆ° itemsTableContainer');
                return;
            }
            
            // æ¸…ç©ºåŸæœ‰å…§å®¹
            container.innerHTML = '';
            
            // å¦‚æœæ²’æœ‰é …ç›®ï¼Œé¡¯ç¤ºæç¤º
            if (!items || items.length === 0) {
                container.innerHTML = '<p style="color: #999; padding: 20px; text-align: center;">æœªæå–åˆ°å“é …æ˜ç´°</p>';
                return;
            }
            
            // å»ºç«‹è¡¨æ ¼
            const table = document.createElement('table');
            table.style.cssText = 'width: 100%; border-collapse: collapse; font-size: 14px;';
            
            // è¡¨é ­
            const thead = document.createElement('thead');
            thead.innerHTML = `
                <tr style="background: #f0f0f0; border-bottom: 2px solid #667eea;">
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #333;">Line</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #333;">Item No.</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #333;">Description</th>
                    <th style="padding: 12px; text-align: right; font-weight: 600; color: #333;">Qty</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #333;">Unit</th>
                    <th style="padding: 12px; text-align: right; font-weight: 600; color: #333;">Unit Price</th>
                    <th style="padding: 12px; text-align: right; font-weight: 600; color: #333;">Amount</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #333;">PO No.</th>
                </tr>
            `;
            table.appendChild(thead);
            
            // è¡¨é«”
            const tbody = document.createElement('tbody');
            items.forEach((item, idx) => {
                const tr = document.createElement('tr');
                tr.style.cssText = idx % 2 === 0 ? 'background: #fafafa;' : 'background: white;';
                tr.style.borderBottom = '1px solid #e0e0e0';
                
                // å®‰å…¨åœ°è½‰æ›æ•¸å€¼
                const quantity = parseInt(item.quantity) || 0;
                const unitPrice = parseFloat(item.unitPrice) || 0;
                const amount = parseFloat(item.amount) || 0;
                
                const missingItemNo = !item.itemNo || item.itemNo === 'null';
                
                try {
                    tr.innerHTML = `
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0;">${item.lineNo || idx + 1}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; ${missingItemNo ? 'color: #999; font-style: italic;' : ''}">${item.itemNo || '(ç¼ºå¤±)'}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; ${!item.description || item.description === 'null' ? 'color: #999; font-style: italic;' : ''}">${item.description || '(ç¼ºå¤±)'}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right; font-weight: 600;">${quantity.toLocaleString()}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: left;">${item.unit || '-'}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right;">$${unitPrice.toFixed(4)}</td>
                        <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right; font-weight: 600; color: #667eea;">$${amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                        <td style="padding: 12px;">${item.poNo || '-'}</td>
                    `;
                } catch (e) {
                    console.warn('âš ï¸ æ¸²æŸ“è¡¨æ ¼è¡Œå‡ºéŒ¯:', e, item);
                    tr.innerHTML = `
                        <td colspan="8" style="padding: 12px; color: #c33;">âš ï¸ è³‡æ–™æ ¼å¼éŒ¯èª¤ï¼Œç„¡æ³•é¡¯ç¤ºè©²è¡Œ</td>
                    `;
                }
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            
            container.appendChild(table);
            console.log('âœ… å“é …è¡¨æ ¼å·²æ›´æ–°ï¼Œå…± ' + items.length + ' ç­†');
        }

        function updateAmountInfo(extracted) {
            const amountSection = document.querySelectorAll('.ocr-data-card')[3];
            if (!amountSection) {
                console.warn('æ‰¾ä¸åˆ°é‡‘é¡è³‡è¨Šå€å¡Š');
                return;
            }
            const items = amountSection.querySelectorAll('.data-value');
            
            // è¨ˆç®—å„é …é‡‘é¡ - å®‰å…¨è½‰æ›ç‚ºæ•¸å€¼
            const totalItems = extracted.items || [];
            const salesAmount = parseFloat(extracted.totalAmount) || 0;
            const tax = salesAmount * 0.05; // å‡è¨­ç¨…ç‡ 5%
            const total = salesAmount + tax;
            
            try {
                if (items[0]) items[0].textContent = `${extracted.currency || 'USD'} ${salesAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                if (items[1]) items[1].textContent = `${extracted.currency || 'USD'} ${tax.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                if (items[2]) items[2].textContent = 'âœ“ (æ‡‰ç¨…)';
                if (items[3]) items[3].textContent = '-';
                if (items[4]) items[4].textContent = `${extracted.currency || 'USD'} ${total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            } catch (e) {
                console.warn('âš ï¸ æ›´æ–°é‡‘é¡è³‡è¨Šæ™‚å‡ºéŒ¯:', e);
            }
            console.log('âœ… é‡‘é¡è³‡è¨Šå·²æ›´æ–°:', salesAmount);
        }

        function updateRemarksInfo(extracted) {
            const remarksSection = document.querySelectorAll('.ocr-data-card')[4];
            if (!remarksSection) {
                console.warn('æ‰¾ä¸åˆ°å‚™è¨»è³‡è¨Šå€å¡Š');
                return;
            }
            const remarksText = remarksSection.querySelector('.remarks-box p');
            if (remarksText) {
                remarksText.textContent = `Origin: ${extracted.origin || '-'} | Trade Term: ${extracted.tradeTerm || '-'} | Currency: ${extracted.currency || 'USD'}`;
            }
            
            const remarkItems = remarksSection.querySelectorAll('.data-grid .data-value');
            if (remarkItems[0]) remarkItems[0].textContent = extracted.invoiceNo || '-';
            if (remarkItems[1]) remarkItems[1].textContent = extracted.currency || 'USD';
            if (remarkItems[2]) remarkItems[2].textContent = '-'; // ç„¡åŒ¯ç‡
            if (remarkItems[3]) {
                const totalAmount = parseFloat(extracted.totalAmount) || 0;
                remarkItems[3].textContent = `${extracted.currency} ${totalAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            }
            if (remarkItems[4]) remarkItems[4].textContent = `-`; // ç„¡åŸå¹£ç¸½é¡
            if (remarkItems[5]) remarkItems[5].textContent = '-'; // ç„¡é‹é€åœ‹å®¶
            console.log('âœ… å‚™è¨»è³‡è¨Šå·²æ›´æ–°');
        }

        function updateFilePreview(extracted) {
            console.log('ğŸ“„ æ›´æ–°æª”æ¡ˆé è¦½ï¼Œextracted:', extracted);
            
            const fileNameElement = document.querySelector('.file-preview-info h4');
            if (fileNameElement) {
                const seller = extracted.seller || 'Invoice';
                const invoiceNo = extracted.invoiceNo || 'Unknown';
                fileNameElement.textContent = `${seller}_${invoiceNo}.pdf`;
                console.log('  æª”æ¡ˆåç¨±:', fileNameElement.textContent);
            }
            
            const fileInfoElement = document.querySelector('.file-preview-info p');
            if (fileInfoElement) {
                const invoiceNo = extracted.invoiceNo || 'N/A';
                const date = extracted.date || 'N/A';
                const itemCount = (extracted.items || []).length;
                fileInfoElement.textContent = `ç™¼ç¥¨è™Ÿç¢¼: ${invoiceNo} | æ—¥æœŸ: ${date} | å“é …æ•¸: ${itemCount}`;
                console.log('  æª”æ¡ˆè³‡è¨Š:', fileInfoElement.textContent);
            }
            console.log('âœ… æª”æ¡ˆé è¦½å·²æ›´æ–°');
        }

        // ===== æ–°å¢è¡ŒåŠŸèƒ½ =====
        function toggleNewRowForm() {
            const form = document.getElementById('newRowForm');
            form.classList.toggle('show');
            
            if (form.classList.contains('show')) {
                document.getElementById('newLine').focus();
            }
        }

        function addNewRow() {
            const line = document.getElementById('newLine').value;
            const itemNo = document.getElementById('newItemNo').value;
            const description = document.getElementById('newDescription').value;
            const qty = document.getElementById('newQty').value;
            const unit = document.getElementById('newUnit').value;
            const unitPrice = document.getElementById('newUnitPrice').value;
            const amount = document.getElementById('newAmount').value;
            const poNo = document.getElementById('newPoNo').value;

            // é©—è­‰å¿…å¡«æ¬„ä½
            if (!line || !qty) {
                alert('è«‹å¡«å…¥è¡Œè™Ÿå’Œæ•¸é‡');
                return;
            }

            // æ‰¾åˆ°è¡¨æ ¼ä¸¦æ’å…¥æ–°è¡Œ
            const container = document.getElementById('itemsTableContainer');
            const table = container.querySelector('table');
            
            if (!table) {
                alert('æ‰¾ä¸åˆ°è¡¨æ ¼');
                return;
            }

            const tbody = table.querySelector('tbody');
            const newRow = document.createElement('tr');
            const rowCount = tbody.querySelectorAll('tr').length;
            newRow.style.cssText = rowCount % 2 === 0 ? 'background: #fafafa;' : 'background: white;';
            newRow.style.borderBottom = '1px solid #e0e0e0';

            newRow.innerHTML = `
                <td style="padding: 12px; border-right: 1px solid #e0e0e0;">${line}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0;">${itemNo || '(æ–°å¢)'}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0;">${description || '(æ–°å¢)'}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right; font-weight: 600;">${parseInt(qty).toLocaleString()}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: left;">${unit}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right;">$${parseFloat(unitPrice || 0).toFixed(4)}</td>
                <td style="padding: 12px; border-right: 1px solid #e0e0e0; text-align: right; font-weight: 600; color: #667eea;">$${parseFloat(amount || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                <td style="padding: 12px;">${poNo || '-'}</td>
            `;

            // ç‚ºæ–°è¡Œæ·»åŠ ç·¨è¼¯åŠŸèƒ½
            newRow.querySelectorAll('td').forEach(cell => {
                cell.style.cursor = 'pointer';
                cell.addEventListener('click', (e) => {
                    e.stopPropagation();
                    startEditingCell(cell);
                });
            });

            tbody.appendChild(newRow);

            console.log(`âœ… æ–°å¢å“é …: Line ${line} - ${description}`);
            
            // é‡ç½®è¡¨å–®
            document.getElementById('newRowForm').reset();
            toggleNewRowForm();
            
            alert(`âœ… å·²æ–°å¢å“é …\n\nè¡Œè™Ÿ: ${line}\nå“è™Ÿ: ${itemNo}\nèªªæ˜: ${description}`);
        }

        // ===== ç·¨è¼¯æ¨¡å¼åŠŸèƒ½ =====
        let editedData = new Map(); // å„²å­˜ç·¨è¼¯éçš„è³‡æ–™

        function enableEditMode() {
            console.log('ğŸ“ å•Ÿç”¨ç·¨è¼¯æ¨¡å¼ - æ‰€æœ‰æ¬„ä½å¯ç›´æ¥ç·¨è¼¯');
            
            // å•Ÿç”¨æ‰€æœ‰ data-value çš„ç·¨è¼¯
            const dataValues = document.querySelectorAll('.data-value');
            dataValues.forEach(elem => {
                elem.style.cursor = 'pointer';
                elem.style.borderRadius = '4px';
                elem.style.padding = '4px 8px';
                elem.addEventListener('click', (e) => {
                    e.stopPropagation();
                    startEditingField(elem);
                });
            });

            // å•Ÿç”¨è¡¨æ ¼å–®å…ƒæ ¼çš„ç·¨è¼¯
            const tableCells = document.querySelectorAll('tbody td');
            tableCells.forEach(cell => {
                if (cell.textContent.trim()) {
                    cell.style.cursor = 'pointer';
                    cell.style.padding = '12px';
                    cell.addEventListener('click', (e) => {
                        e.stopPropagation();
                        startEditingCell(cell);
                    });
                }
            });
        }

        function startEditingField(elem) {
            if (elem.querySelector('.editable-input')) return; // å·²åœ¨ç·¨è¼¯ä¸­

            const originalValue = elem.textContent;
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'editable-input';
            input.value = originalValue;

            const saveBtn = document.createElement('button');
            saveBtn.className = 'save-btn';
            saveBtn.textContent = 'âœ“';
            saveBtn.style.marginLeft = '4px';
            saveBtn.onclick = (e) => {
                e.stopPropagation();
                const newValue = input.value;
                elem.textContent = newValue;
                elem.style.cursor = 'pointer';
                editedData.set(elem, newValue);
                console.log(`âœ… æ¬„ä½å·²æ›´æ–°: "${originalValue}" â†’ "${newValue}"`);
            };

            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'cancel-btn';
            cancelBtn.textContent = 'âœ•';
            cancelBtn.style.marginLeft = '4px';
            cancelBtn.onclick = (e) => {
                e.stopPropagation();
                elem.textContent = originalValue;
                elem.style.cursor = 'pointer';
            };

            elem.textContent = '';
            elem.appendChild(input);
            elem.appendChild(saveBtn);
            elem.appendChild(cancelBtn);
            
            input.focus();
            input.select();
        }

        function startEditingCell(cell) {
            if (cell.querySelector('.editable-input')) return; // å·²åœ¨ç·¨è¼¯ä¸­

            const originalValue = cell.textContent;
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'editable-input';
            input.value = originalValue;
            input.style.width = '90%';
            input.style.marginRight = '4px';

            const saveBtn = document.createElement('button');
            saveBtn.className = 'save-btn';
            saveBtn.textContent = 'âœ“';
            saveBtn.style.padding = '4px 8px';
            saveBtn.style.fontSize = '12px';
            saveBtn.onclick = (e) => {
                e.stopPropagation();
                const newValue = input.value;
                cell.textContent = newValue;
                cell.style.cursor = 'pointer';
                editedData.set(cell, newValue);
                console.log(`âœ… è¡¨æ ¼å·²æ›´æ–°: "${originalValue}" â†’ "${newValue}"`);
            };

            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'cancel-btn';
            cancelBtn.textContent = 'âœ•';
            cancelBtn.style.padding = '4px 8px';
            cancelBtn.style.fontSize = '12px';
            cancelBtn.style.marginLeft = '2px';
            cancelBtn.onclick = (e) => {
                e.stopPropagation();
                cell.textContent = originalValue;
                cell.style.cursor = 'pointer';
            };

            cell.textContent = '';
            cell.appendChild(input);
            cell.appendChild(saveBtn);
            cell.appendChild(cancelBtn);
            
            input.focus();
            input.select();
        }

        function saveAndContinue() {
            console.log('ğŸ’¾ ä¿å­˜ç·¨è¼¯ä¸¦ç¹¼çºŒ');
            
            // æ”¶é›†æ‰€æœ‰ç·¨è¼¯éçš„è³‡æ–™
            const edits = Array.from(editedData.entries()).map(([elem, value]) => ({
                element: elem.textContent,
                newValue: value
            }));
            
            console.log('ğŸ“Š ç·¨è¼¯å…§å®¹:', edits);
            alert(`âœ… å·²ä¿å­˜ ${editedData.size} é …ç·¨è¼¯\n\nç·¨è¼¯å…§å®¹å·²è¨˜éŒ„ï¼Œæº–å‚™ç¹¼çºŒä¸‹ä¸€æ­¥`);
        }

        // ===== èˆŠçš„åˆ‡æ›å‡½æ•¸ï¼ˆä¿ç•™ä»¥é˜²éœ€è¦ï¼‰ =====
        let isEditMode = true; // é»˜èªå•Ÿç”¨

        function toggleEditMode() {
            // æ­¤å‡½æ•¸å·²æ£„ç”¨ï¼Œç›´æ¥å•Ÿç”¨ç·¨è¼¯æ¨¡å¼
        }

        function updateActionButtons() {
            // æ­¤å‡½æ•¸å·²æ£„ç”¨
        }
    </script>
</body>
</html>
